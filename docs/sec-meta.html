<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 12 Meta-analysis and Publication Bias | Statistical Tools for Causal Inference</title>
  <meta name="description" content="This is an open source collaborative book.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 12 Meta-analysis and Publication Bias | Statistical Tools for Causal Inference" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an open source collaborative book." />
  <meta name="github-repo" content="chabefer/STCI" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Meta-analysis and Publication Bias | Statistical Tools for Causal Inference" />
  
  <meta name="twitter:description" content="This is an open source collaborative book." />
  

<meta name="author" content="The SKY Community">


<meta name="date" content="2019-09-19">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="Distribution.html">
<link rel="next" href="Bounds.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







$$
\newcommand{\uns}[1]{\mathbf{1}[#1]}
\newcommand{\esp}[1]{\mathbf{E}[#1]}
\newcommand{\Ind}{\perp\kern-5pt\perp}
\newcommand{\var}[1]{\mathbf{V}[ #1 ]}
\newcommand{\cov}[1]{\mathbf{C}[ #1 ]}
\newcommand{\plim}[1]{\text{plim}_{ #1 \rightarrow \infty}}
\newcommand{\plims}{\text{plim}}
\newcommand{\partder}[2]{\frac{\partial #1}{\partial #2}}
\DeclareMathOperator{\diag}{diag}
$$


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Tools for Causal Inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>I Fundamental Problems of Inference</b></span></li>
<li class="chapter" data-level="" data-path="introduction-the-two-fundamental-problems-of-inference.html"><a href="introduction-the-two-fundamental-problems-of-inference.html"><i class="fa fa-check"></i>Introduction: the Two Fundamental Problems of Inference</a></li>
<li class="chapter" data-level="1" data-path="FPCI.html"><a href="FPCI.html"><i class="fa fa-check"></i><b>1</b> Fundamental Problem of Causal Inference</a><ul>
<li class="chapter" data-level="1.1" data-path="FPCI.html"><a href="FPCI.html#rubin-causal-model"><i class="fa fa-check"></i><b>1.1</b> Rubin Causal Model</a><ul>
<li class="chapter" data-level="1.1.1" data-path="FPCI.html"><a href="FPCI.html#treatment-allocation-rule"><i class="fa fa-check"></i><b>1.1.1</b> Treatment allocation rule</a></li>
<li class="chapter" data-level="1.1.2" data-path="FPCI.html"><a href="FPCI.html#potential-outcomes"><i class="fa fa-check"></i><b>1.1.2</b> Potential outcomes</a></li>
<li class="chapter" data-level="1.1.3" data-path="FPCI.html"><a href="FPCI.html#switching-equation"><i class="fa fa-check"></i><b>1.1.3</b> Switching equation</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="FPCI.html"><a href="FPCI.html#treatment-effects"><i class="fa fa-check"></i><b>1.2</b> Treatment effects</a><ul>
<li class="chapter" data-level="1.2.1" data-path="FPCI.html"><a href="FPCI.html#individual-level-treatment-effects"><i class="fa fa-check"></i><b>1.2.1</b> Individual level treatment effects</a></li>
<li class="chapter" data-level="1.2.2" data-path="FPCI.html"><a href="FPCI.html#average-treatment-effect-on-the-treated"><i class="fa fa-check"></i><b>1.2.2</b> Average treatment effect on the treated</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="FPCI.html"><a href="FPCI.html#fundamental-problem-of-causal-inference"><i class="fa fa-check"></i><b>1.3</b> Fundamental problem of causal inference</a></li>
<li class="chapter" data-level="1.4" data-path="FPCI.html"><a href="FPCI.html#intuitive-estimators-confounding-factors-and-selection-bias"><i class="fa fa-check"></i><b>1.4</b> Intuitive estimators, confounding factors and selection bias</a><ul>
<li class="chapter" data-level="1.4.1" data-path="FPCI.html"><a href="FPCI.html#withwithout-comparison-selection-bias-and-cross-sectional-confounders"><i class="fa fa-check"></i><b>1.4.1</b> With/Without comparison, selection bias and cross-sectional confounders</a></li>
<li class="chapter" data-level="1.4.2" data-path="FPCI.html"><a href="FPCI.html#the-beforeafter-comparison-temporal-confounders-and-time-trend-bias"><i class="fa fa-check"></i><b>1.4.2</b> The before/after comparison, temporal confounders and time trend bias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="FPSI.html"><a href="FPSI.html"><i class="fa fa-check"></i><b>2</b> Fundamental Problem of Statistical Inference</a><ul>
<li class="chapter" data-level="2.1" data-path="FPSI.html"><a href="FPSI.html#sec:sampnoise"><i class="fa fa-check"></i><b>2.1</b> What is sampling noise? Definition and illustration</a><ul>
<li class="chapter" data-level="2.1.1" data-path="FPSI.html"><a href="FPSI.html#sec:definitionnoise"><i class="fa fa-check"></i><b>2.1.1</b> Sampling noise, a definition</a></li>
<li class="chapter" data-level="2.1.2" data-path="FPSI.html"><a href="FPSI.html#sec:illusnoisepop"><i class="fa fa-check"></i><b>2.1.2</b> Sampling noise for the population treatment effect</a></li>
<li class="chapter" data-level="2.1.3" data-path="FPSI.html"><a href="FPSI.html#sec:illusnoisesamp"><i class="fa fa-check"></i><b>2.1.3</b> Sampling noise for the sample treatment effect</a></li>
<li class="chapter" data-level="2.1.4" data-path="FPSI.html"><a href="FPSI.html#sec:confinterv"><i class="fa fa-check"></i><b>2.1.4</b> Building confidence intervals from estimates of sampling noise</a></li>
<li class="chapter" data-level="2.1.5" data-path="FPSI.html"><a href="FPSI.html#reporting-sampling-noise-a-proposal"><i class="fa fa-check"></i><b>2.1.5</b> Reporting sampling noise: a proposal</a></li>
<li class="chapter" data-level="2.1.6" data-path="FPSI.html"><a href="FPSI.html#sec:effectsize"><i class="fa fa-check"></i><b>2.1.6</b> Using effect sizes to normalize the reporting of treatment effects and their precision</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="FPSI.html"><a href="FPSI.html#sec:estimsampnoise"><i class="fa fa-check"></i><b>2.2</b> Estimating sampling noise</a><ul>
<li class="chapter" data-level="2.2.1" data-path="FPSI.html"><a href="FPSI.html#sec:assumptions"><i class="fa fa-check"></i><b>2.2.1</b> Assumptions</a></li>
<li class="chapter" data-level="2.2.2" data-path="FPSI.html"><a href="FPSI.html#sec:cheb"><i class="fa fa-check"></i><b>2.2.2</b> Using Chebyshev’s inequality</a></li>
<li class="chapter" data-level="2.2.3" data-path="FPSI.html"><a href="FPSI.html#sec:CLT"><i class="fa fa-check"></i><b>2.2.3</b> Using the Central Limit Theorem</a></li>
<li class="chapter" data-level="2.2.4" data-path="FPSI.html"><a href="FPSI.html#sec:resamp"><i class="fa fa-check"></i><b>2.2.4</b> Using resampling methods</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Methods of Causal Inference</b></span></li>
<li class="chapter" data-level="3" data-path="RCT.html"><a href="RCT.html"><i class="fa fa-check"></i><b>3</b> Randomized Controlled Trials</a><ul>
<li class="chapter" data-level="3.1" data-path="RCT.html"><a href="RCT.html#sec:design1"><i class="fa fa-check"></i><b>3.1</b> Brute Force Design</a><ul>
<li class="chapter" data-level="3.1.1" data-path="RCT.html"><a href="RCT.html#identification"><i class="fa fa-check"></i><b>3.1.1</b> Identification</a></li>
<li class="chapter" data-level="3.1.2" data-path="RCT.html"><a href="RCT.html#estimating-ate"><i class="fa fa-check"></i><b>3.1.2</b> Estimating ATE</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="RCT.html"><a href="RCT.html#sec:design2"><i class="fa fa-check"></i><b>3.2</b> Randomization After Self-Selection</a><ul>
<li class="chapter" data-level="3.2.1" data-path="RCT.html"><a href="RCT.html#identification-1"><i class="fa fa-check"></i><b>3.2.1</b> Identification</a></li>
<li class="chapter" data-level="3.2.2" data-path="RCT.html"><a href="RCT.html#estimating-tt"><i class="fa fa-check"></i><b>3.2.2</b> Estimating TT</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="RCT.html"><a href="RCT.html#sec:design3"><i class="fa fa-check"></i><b>3.3</b> Randomization After Eligibility</a><ul>
<li class="chapter" data-level="3.3.1" data-path="RCT.html"><a href="RCT.html#identification-2"><i class="fa fa-check"></i><b>3.3.1</b> Identification</a></li>
<li class="chapter" data-level="3.3.2" data-path="RCT.html"><a href="RCT.html#estimating-the-ite-and-the-tt"><i class="fa fa-check"></i><b>3.3.2</b> Estimating the ITE and the TT</a></li>
<li class="chapter" data-level="3.3.3" data-path="RCT.html"><a href="RCT.html#estimating-sampling-noise-2"><i class="fa fa-check"></i><b>3.3.3</b> Estimating sampling noise</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="RCT.html"><a href="RCT.html#sec:design4"><i class="fa fa-check"></i><b>3.4</b> Encouragement Design</a></li>
<li class="chapter" data-level="3.5" data-path="RCT.html"><a href="RCT.html#sec:threats"><i class="fa fa-check"></i><b>3.5</b> Threats to the validity of RCTs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="NE.html"><a href="NE.html"><i class="fa fa-check"></i><b>4</b> Natural Experiments</a></li>
<li class="chapter" data-level="5" data-path="sec-OM.html"><a href="sec-OM.html"><i class="fa fa-check"></i><b>5</b> Observational Methods</a></li>
<li class="part"><span><b>III Additional Topics</b></span></li>
<li class="chapter" data-level="6" data-path="Power.html"><a href="Power.html"><i class="fa fa-check"></i><b>6</b> Power Analysis</a></li>
<li class="chapter" data-level="7" data-path="Placebo.html"><a href="Placebo.html"><i class="fa fa-check"></i><b>7</b> Placebo Tests</a></li>
<li class="chapter" data-level="8" data-path="cluster.html"><a href="cluster.html"><i class="fa fa-check"></i><b>8</b> Clustering</a></li>
<li class="chapter" data-level="9" data-path="LaLonde.html"><a href="LaLonde.html"><i class="fa fa-check"></i><b>9</b> LaLonde Tests</a></li>
<li class="chapter" data-level="10" data-path="Diffusion.html"><a href="Diffusion.html"><i class="fa fa-check"></i><b>10</b> Diffusion effects</a></li>
<li class="chapter" data-level="11" data-path="Distribution.html"><a href="Distribution.html"><i class="fa fa-check"></i><b>11</b> Distributional effects</a></li>
<li class="chapter" data-level="12" data-path="sec-meta.html"><a href="sec-meta.html"><i class="fa fa-check"></i><b>12</b> Meta-analysis and Publication Bias</a><ul>
<li class="chapter" data-level="12.1" data-path="sec-meta.html"><a href="sec-meta.html#meta-analysis"><i class="fa fa-check"></i><b>12.1</b> Meta-analysis</a><ul>
<li class="chapter" data-level="12.1.1" data-path="sec-meta.html"><a href="sec-meta.html#basic-setting"><i class="fa fa-check"></i><b>12.1.1</b> Basic setting</a></li>
<li class="chapter" data-level="12.1.2" data-path="sec-meta.html"><a href="sec-meta.html#meta-analysis-as-a-weighted-average"><i class="fa fa-check"></i><b>12.1.2</b> Meta-analysis as a weighted average</a></li>
<li class="chapter" data-level="12.1.3" data-path="sec-meta.html"><a href="sec-meta.html#constantly-updated-meta-analysis"><i class="fa fa-check"></i><b>12.1.3</b> Constantly updated meta-analysis</a></li>
<li class="chapter" data-level="12.1.4" data-path="sec-meta.html"><a href="sec-meta.html#testing-for-the-homogeneity-of-treatment-effects"><i class="fa fa-check"></i><b>12.1.4</b> Testing for the homogeneity of treatment effects</a></li>
<li class="chapter" data-level="12.1.5" data-path="sec-meta.html"><a href="sec-meta.html#meta-analysis-when-treatment-effects-are-heterogeneous"><i class="fa fa-check"></i><b>12.1.5</b> Meta-analysis when treatment effects are heterogeneous</a></li>
<li class="chapter" data-level="12.1.6" data-path="sec-meta.html"><a href="sec-meta.html#meta-regression"><i class="fa fa-check"></i><b>12.1.6</b> Meta-regression</a></li>
<li class="chapter" data-level="12.1.7" data-path="sec-meta.html"><a href="sec-meta.html#why-vote-counting-does-not-work"><i class="fa fa-check"></i><b>12.1.7</b> Why vote-counting does not work</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sec-meta.html"><a href="sec-meta.html#publication-bias"><i class="fa fa-check"></i><b>12.2</b> Publication bias</a><ul>
<li class="chapter" data-level="12.2.1" data-path="sec-meta.html"><a href="sec-meta.html#sources-of-publication-bias"><i class="fa fa-check"></i><b>12.2.1</b> Sources of publication bias</a></li>
<li class="chapter" data-level="12.2.2" data-path="sec-meta.html"><a href="sec-meta.html#detecting-and-correcting-for-publication-bias"><i class="fa fa-check"></i><b>12.2.2</b> Detecting and correcting for publication bias</a></li>
<li class="chapter" data-level="12.2.3" data-path="sec-meta.html"><a href="sec-meta.html#vote-counting-and-publication-bias"><i class="fa fa-check"></i><b>12.2.3</b> Vote counting and publication bias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Bounds.html"><a href="Bounds.html"><i class="fa fa-check"></i><b>13</b> Bounds</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="proofs.html"><a href="proofs.html"><i class="fa fa-check"></i><b>A</b> Proofs</a><ul>
<li class="chapter" data-level="A.1" data-path="proofs.html"><a href="proofs.html#proofs-of-results-in-chapter-reffpsi"><i class="fa fa-check"></i><b>A.1</b> Proofs of results in Chapter @ref(FPSI)</a><ul>
<li class="chapter" data-level="A.1.1" data-path="proofs.html"><a href="proofs.html#proofcheb"><i class="fa fa-check"></i><b>A.1.1</b> Proof of Theorem @ref(thm:uppsampnoise)</a></li>
<li class="chapter" data-level="A.1.2" data-path="proofs.html"><a href="proofs.html#proofCLT"><i class="fa fa-check"></i><b>A.1.2</b> Proof of Theorem @ref(thm:asympnoiseWW)</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="proofs.html"><a href="proofs.html#proofs-of-results-in-chapter-refrct"><i class="fa fa-check"></i><b>A.2</b> Proofs of results in Chapter @ref(RCT)</a><ul>
<li class="chapter" data-level="A.2.1" data-path="proofs.html"><a href="proofs.html#proofWaldIV"><i class="fa fa-check"></i><b>A.2.1</b> Proof of Lemma @ref(lem:WaldIV)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Tools for Causal Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec:meta" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> Meta-analysis and Publication Bias</h1>
<p>When several research teams work on a similar topic, they obtain and publish several estimates for the same program of for similar programs. For example, teams of doctors regularly test the same treatment on different samples or populations in order to refine the estimated effect. Similarly, economists report on the effects of similar types of programs (Conditional and Unconditional Cash Transfers, Job Training Programs, microcredit, etc) implemented in different countries.</p>
<p>Meta-analysis aims at summarizing and synthetizing the available evidence with two main goals in mind:</p>
<ol style="list-style-type: decimal">
<li>Increasing precision by providing an average estimated effect combining several estimates</li>
<li>Explaining variations in treatment effectiveness by relating changes in effect size to changes in sample characteristics.</li>
</ol>
<p>One key issue that meta-analysis has to face – actually, we all have to face it, meta-analysis simply makes it more apparent – is that of publication bias. Publication bias is due to the fact that referees and editors have a marked preference for publishing statistically significant results. The problem with this approach is that the distribution of published results is going to be censored on the left: we will have more statistically significant results in the published record, and as a consequence, the average ublished result will be an upward biased estimate of the true treatment effect in the population. This is potentially a very severe problem, if the amount of censoring due to publication bias is large. Eventually, this hinges on the true distribution of treatment effects: if it is centered on zero or close to zero, we run the risk of having very large publication bias.</p>
<p>In this chapter, I present first the tools for meta-analysis, and I then move on to testing and correcting for publication bias.</p>
<div id="meta-analysis" class="section level2">
<h2><span class="header-section-number">12.1</span> Meta-analysis</h2>
<p>There are several approaches and refinements to meta-analysis. In this section, I am going to present only the most important ones. I’ll defer the reader to other more specialized publications if needed.</p>
<p>I first present the basics of meta-analysis: the constitution and structure of the sample. Second, I present the simplest method to aggregate effects: the weighted average. Third, I present tests for deciding whether the effects are from a homogeneous or a heterogeneous population. Fourth, I explain how to conduct a meta-analysis when effects are heterogeneous. Fifth, I cover the meta-regression that we use to account for heterogeneity in treatment effects. Finally, I explain why usual intuitive methods such as vote-counting are biased.</p>
<div id="basic-setting" class="section level3">
<h3><span class="header-section-number">12.1.1</span> Basic setting</h3>
<p>The basic setting for a meta-analysis is that you have access to a list of estimates for the effect of a given program and for their precision. These estimates come from the literature, searching published and unpublished sources alike. This data is usually collected after an extensive search of bibliographic databases. Then, one has to select among all the studies selected by the search the ones that are actualy relevant. This is the most excruciating part of a meta-analysis, since a lot of the studies selected by hte search algorithm are actually irrelevant. Finally, one has to extract from each relevant paper an estimate of the effect of the treatment and of its precision. In general, one tries to choose standardized estimates such as the effect size (see Section <a href="FPSI.html#sec:effectsize">2.1.6</a> for a definition) and its standard error. After all this process, we should end up with a dataset like: <span class="math inline">\(\left\{(\hat{\theta}_k,\hat{\sigma}_k)\right\}_{k=1}^N\)</span>, with <span class="math inline">\(\hat{\theta}_k\)</span> the estimated effect size, <span class="math inline">\(\hat{\sigma}_k\)</span> its estimated standard error, and <span class="math inline">\(N\)</span> the number of included studies.</p>

<div class="example">
<span id="exm:unnamed-chunk-102" class="example"><strong>Example 12.1  </strong></span>Let’s see how such a dataset would look like? Let’s build one from our simulations.
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N.sample &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>)
N.plot.ES.CLT &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">1</span>)
data.meta &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ES=</span><span class="kw">numeric</span>(),
                          <span class="dt">se=</span><span class="kw">numeric</span>())

se.ww.CLT.ES &lt;-<span class="st"> </span><span class="cf">function</span>(N,v1,v0,p){
  <span class="kw">return</span>(<span class="kw">sqrt</span>((v1<span class="op">/</span>p<span class="op">+</span>v0<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>p))<span class="op">/</span>N)<span class="op">/</span>v0)
}

<span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(N.sample)){
  <span class="kw">set.seed</span>(<span class="dv">1234</span>)
  simuls.ww[[k]]<span class="op">$</span>se.ES &lt;-<span class="st"> </span><span class="kw">se.ww.CLT.ES</span>(N.sample[[k]],simuls.ww[[k]][,<span class="st">&#39;V1&#39;</span>],simuls.ww[[k]][,<span class="st">&#39;V0&#39;</span>],simuls.ww[[k]][,<span class="st">&#39;p&#39;</span>])
  test.ES &lt;-<span class="st"> </span>simuls.ww[[k]][<span class="kw">sample</span>(N.plot.ES.CLT[[k]]),<span class="kw">c</span>(<span class="st">&#39;ES&#39;</span>,<span class="st">&#39;se.ES&#39;</span>)]
  test.ES<span class="op">$</span>N &lt;-<span class="st"> </span><span class="kw">rep</span>(N.sample[[k]],N.plot.ES.CLT[[k]])
  data.meta &lt;-<span class="st"> </span><span class="kw">rbind</span>(data.meta,test.ES)
  }

data.meta<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data.meta)
<span class="co">#data.meta$N &lt;- factor(data.meta$N,levels(N.sample))</span>

  <span class="kw">ggplot</span>(data.meta, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">as.factor</span>(id), <span class="dt">y=</span>ES)) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="kw">position_dodge</span>(), <span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">colour=</span><span class="st">&#39;black&#39;</span>) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>ES<span class="op">-</span><span class="kw">qnorm</span>((delta.<span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>se.ES, <span class="dt">ymax=</span>ES<span class="op">+</span><span class="kw">qnorm</span>((delta.<span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>se.ES), <span class="dt">width=</span>.<span class="dv">2</span>,<span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>),<span class="dt">color=</span><span class="st">&#39;blue&#39;</span>) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span><span class="kw">ES</span>(param)), <span class="dt">colour=</span><span class="st">&quot;#990000&quot;</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="op">+</span>
<span class="st">      </span><span class="kw">xlab</span>(<span class="st">&quot;Studies&quot;</span>)<span class="op">+</span>
<span class="st">      </span><span class="kw">ylab</span>(<span class="st">&quot;Effect size&quot;</span>)<span class="op">+</span>
<span class="st">      </span><span class="kw">theme_bw</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:confintervalESCLT"></span>
<img src="STCI_files/figure-html/confintervalESCLT-1.png" alt="Example data set: effect sizes and confidence intervals with $\delta=$ 0.95" width="60%" />
<p class="caption">
Figure 12.1: Example data set: effect sizes and confidence intervals with <span class="math inline">\(\delta=\)</span> 0.95
</p>
</div>
<p>Figure <a href="sec-meta.html#fig:confintervalESCLT">12.1</a> shows the resulting sample. I’ve selected 10 studies with <span class="math inline">\(N=\)</span> 100, 7 studies with <span class="math inline">\(N=\)</span> 1000, 2 studies with <span class="math inline">\(N=\)</span> 10^{4}, and 1 study with <span class="math inline">\(N=\)</span> 10^{5}. The studies are represented in that order, mimicking the increasing sample size of studies that accumulate evidence on a treatment, probably with studies with a small sample size at first, and only large studies at the end for the most promising treatments.</p>
</div>
<div id="meta-analysis-as-a-weighted-average" class="section level3">
<h3><span class="header-section-number">12.1.2</span> Meta-analysis as a weighted average</h3>
<p>The key idea of meta-analysis is to combine the effect size estimates stemming from different studies, weighing them by their relative precision.</p>

<div class="definition">
<span id="def:metaweights" class="definition"><strong>Definition 12.1  (Weighted Meta-Analytic Estimator)  </strong></span>The weighted meta-analytic estimator is <span class="math display">\[
\bar{\theta} = \sum_{k=1}^Nw_k\hat{\theta}_k \text{ with } w_k=\frac{\frac{1}{\hat{\sigma}^2_k}}{\sum_{k=1}^N\frac{1}{\hat{\sigma}^2_k}}.
\]</span>
</div>

<p>Under some assumptions, the estimator <span class="math inline">\(\bar{\theta}\)</span> converges to the true effect of the treatment. Let’s delineate these assumptions.</p>

<div class="definition">
<span id="def:metahomo" class="definition"><strong>Definition 12.2  (Homogeneous Treatment Effect)  </strong></span>Each <span class="math inline">\(\hat{\theta}_k\)</span> converges to the same treatment effect <span class="math inline">\(\theta\)</span>.
</div>

<p>Assumption <a href="sec-meta.html#def:metahomo">12.2</a> imposes that all the studies have been drawn from the same population, where the treatment effect is a constant.</p>

<div class="definition">
<span id="def:metaind" class="definition"><strong>Definition 12.3  (Independence of Estimates)  </strong></span>The <span class="math inline">\(\hat{\theta}_k\)</span> are independent from each other.
</div>

<p>Assumption <a href="sec-meta.html#def:metaind">12.3</a> imposes that all the studies estimates are independent from each other. That means that they do not share sampling units and that they are not affected by common shocks.</p>
<p>Under these assumptions, we can show two important results.</p>

<div class="theorem">
<span id="thm:metafixedcons" class="theorem"><strong>Theorem 12.1  (Consistency of the Weighted Meta-Analytic Estimator)  </strong></span>Under Assumptions <a href="sec-meta.html#def:metahomo">12.2</a> and <a href="sec-meta.html#def:metaind">12.3</a>, when the sample size of each study goes to infinity, <span class="math inline">\(\bar{\theta}\approx\theta\)</span>.
</div>


<div class="proof">
 <span class="proof"><em>Proof. </em></span> The Law of Large Number applied to each sample gives the fact that the estimator is a weighted sum of <span class="math inline">\(\theta\)</span> with weights summing to one. Hence the result.
</div>

<p>Theorem <a href="sec-meta.html#thm:metafixedcons">12.1</a> says that the error we are making around the true effect of the treatment goes to zero as the sample size in each study decrease. This is great: aggregating the studies is thus going to get us to the truth.</p>

<div class="remark">
 <span class="remark"><em>Remark. </em></span> One interesting question is whether Theorem <a href="sec-meta.html#thm:metafixedcons">12.1</a> also holds when the size of the individual studies remains fixed and the number of studies goes to infinity, which seems a more natural way to do asymptotics in a meta-analysis. I’m pretty sure that is the case. Indeed, the studies constitute an enormous sample in which we take the average outcomes of the treated on the one hand and of the untreated on the other. These averages differ from the usual ones in the Law of Large Numbers only by the fact that they are not equal to one. But they (i) are independent from the outcomes and (ii) sum to one. As a consequence, I’m pretty sure the Law of Large Numbers also apply in this dimension.
</div>

<p><strong><span style="font-variant: small-caps;">Check if this is a consequence of Kolmogorov’s Law of Large Numbers.</span></strong></p>

<div class="theorem">
<span id="thm:metafixeddis" class="theorem"><strong>Theorem 12.2  (Asymptotic Distribution of the Weighted Meta-Analytic Estimator)  </strong></span>Under Assumptions <a href="sec-meta.html#def:metahomo">12.2</a> and <a href="sec-meta.html#def:metaind">12.3</a>, when the sample size of each study goes to infinity, <span class="math inline">\(\bar{\theta}\stackrel{d}{\rightarrow}\mathcal{N}(\theta,\sigma^2)\)</span>, with <span class="math display">\[
\sigma^2 = \frac{1}{\sum_{k=1}^N\frac{1}{\sigma^2_k}}.
\]</span>
</div>


<div class="proof">
 <span class="proof"><em>Proof. </em></span> <strong><span style="font-variant: small-caps;">To do using the Lindenberg-Levy version of the Central Limit Theorem.</span></strong>
</div>

<p>Theorem <a href="sec-meta.html#thm:metafixeddis">12.2</a> shows that the distribution of the weighted metanalytic estimator converges to a normal, which is very convenient in order to compute sampling noise. In order to obtain an estimator <span class="math inline">\(\hat{\sigma}^2\)</span> of the variance of the meta-analytic estimator, we can simply replace the individual variance terms by their estimates: <span class="math inline">\(\hat{\sigma}_k^2\)</span>.</p>

<div class="remark">
 <span class="remark"><em>Remark. </em></span> I’ve taken Theorem <a href="sec-meta.html#thm:metafixeddis">12.2</a> from Hedges and Olkin, but I think it is much more interesting and correct when the asymptotics goes in the number of studies.
</div>


<div class="remark">
 <span class="remark"><em>Remark. </em></span> According to Hedges and Olkin, the weighted meta-analytic estimator is the most efficient estimator available.
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wmae &lt;-<span class="st"> </span><span class="cf">function</span>(theta,sigma2){
  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">weighted.mean</span>(theta,(<span class="dv">1</span><span class="op">/</span>sigma2)<span class="op">/</span>(<span class="kw">sum</span>(<span class="dv">1</span><span class="op">/</span>sigma2))),<span class="dv">1</span><span class="op">/</span><span class="kw">sum</span>(<span class="dv">1</span><span class="op">/</span>sigma2)))
}</code></pre></div>

<div class="example">
<span id="exm:unnamed-chunk-108" class="example"><strong>Example 12.2  </strong></span>Let’s use our meta-analytic estimator to estimate the effect size of our treatment.
</div>
<p> The estimated treatment effect size with our sample is 0.19 <span class="math inline">\(\pm\)</span> 0.02.</p>
<p><strong><span style="font-variant: small-caps;">Add forest plot.</span></strong></p>
</div>
<div id="constantly-updated-meta-analysis" class="section level3">
<h3><span class="header-section-number">12.1.3</span> Constantly updated meta-analysis</h3>
<p>What would have happened</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cum.wmae.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(k,theta,sigma2){
  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">weighted.mean</span>(theta[<span class="dv">1</span><span class="op">:</span>k],(<span class="dv">1</span><span class="op">/</span>sigma2[<span class="dv">1</span><span class="op">:</span>k])<span class="op">/</span>(<span class="kw">sum</span>(<span class="dv">1</span><span class="op">/</span>sigma2[<span class="dv">1</span><span class="op">:</span>k]))),<span class="dv">1</span><span class="op">/</span><span class="kw">sum</span>(<span class="dv">1</span><span class="op">/</span>sigma2[<span class="dv">1</span><span class="op">:</span>k])))
}

cum.wmae &lt;-<span class="st"> </span><span class="cf">function</span>(theta,sigma2){
  <span class="kw">return</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(theta),cum.wmae.<span class="dv">1</span>,<span class="dt">theta=</span>theta,<span class="dt">sigma2=</span>sigma2))
}

cum.test &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">cum.wmae</span>(data.meta<span class="op">$</span>ES,data.meta<span class="op">$</span>se.ES<span class="op">^</span><span class="dv">2</span>)))
<span class="kw">colnames</span>(cum.test) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;cum.ES&#39;</span>,<span class="st">&#39;cum.var&#39;</span>)
cum.test<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(cum.test)
cum.test<span class="op">$</span>cum.se.ES &lt;-<span class="st"> </span><span class="kw">sqrt</span>(cum.test<span class="op">$</span>cum.var)

  <span class="kw">ggplot</span>(cum.test, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">as.factor</span>(id), <span class="dt">y=</span>cum.ES)) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="kw">position_dodge</span>(), <span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">colour=</span><span class="st">&#39;black&#39;</span>) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>cum.ES<span class="op">-</span><span class="kw">qnorm</span>((delta.<span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>cum.se.ES, <span class="dt">ymax=</span>cum.ES<span class="op">+</span><span class="kw">qnorm</span>((delta.<span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>cum.se.ES), <span class="dt">width=</span>.<span class="dv">2</span>,<span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>),<span class="dt">color=</span><span class="st">&#39;blue&#39;</span>) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span><span class="kw">ES</span>(param)), <span class="dt">colour=</span><span class="st">&quot;#990000&quot;</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="op">+</span>
<span class="st">      </span><span class="kw">xlab</span>(<span class="st">&quot;Studies&quot;</span>)<span class="op">+</span>
<span class="st">      </span><span class="kw">ylab</span>(<span class="st">&quot;Cumulated effect size&quot;</span>)<span class="op">+</span>
<span class="st">      </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="STCI_files/figure-html/cumWMAE-1.png" width="672" /></p>
</div>
<div id="testing-for-the-homogeneity-of-treatment-effects" class="section level3">
<h3><span class="header-section-number">12.1.4</span> Testing for the homogeneity of treatment effects</h3>
</div>
<div id="meta-analysis-when-treatment-effects-are-heterogeneous" class="section level3">
<h3><span class="header-section-number">12.1.5</span> Meta-analysis when treatment effects are heterogeneous</h3>
</div>
<div id="meta-regression" class="section level3">
<h3><span class="header-section-number">12.1.6</span> Meta-regression</h3>
</div>
<div id="why-vote-counting-does-not-work" class="section level3">
<h3><span class="header-section-number">12.1.7</span> Why vote-counting does not work</h3>
</div>
</div>
<div id="publication-bias" class="section level2">
<h2><span class="header-section-number">12.2</span> Publication bias</h2>
<div id="sources-of-publication-bias" class="section level3">
<h3><span class="header-section-number">12.2.1</span> Sources of publication bias</h3>
</div>
<div id="detecting-and-correcting-for-publication-bias" class="section level3">
<h3><span class="header-section-number">12.2.2</span> Detecting and correcting for publication bias</h3>
<div id="p-curving" class="section level4">
<h4><span class="header-section-number">12.2.2.1</span> P-curving</h4>
</div>
<div id="pet-peese" class="section level4">
<h4><span class="header-section-number">12.2.2.2</span> PET-PEESE</h4>
</div>
<div id="kasy-and-andrews-approach" class="section level4">
<h4><span class="header-section-number">12.2.2.3</span> Kasy and Andrews approach</h4>
</div>
<div id="last-approach" class="section level4">
<h4><span class="header-section-number">12.2.2.4</span> Last approach</h4>
</div>
</div>
<div id="vote-counting-and-publication-bias" class="section level3">
<h3><span class="header-section-number">12.2.3</span> Vote counting and publication bias</h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Distribution.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Bounds.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/chabefer/STCI/blob/master/12_Meta.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["STCI.pdf"],
"toc": {
"collapse": "subsection"
},
"toc_depth": 1
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
